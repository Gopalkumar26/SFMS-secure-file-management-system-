{% extends "base.html" %}
{% block title %}2FA Setup â€” SFMS{% endblock %}
{% block content %}
<div class="row justify-content-center">
  <div class="col-md-8">
    <div class="card p-3 card-compact text-center">
      <h5>Enable Two-Factor Authentication (TOTP)</h5>
      <p class="small-muted">Scan the QR code with an authenticator app (Google Authenticator, Authy) or enter the secret manually.</p>

      <div class="d-flex justify-content-center my-3">
        <!-- QR using Google Chart (works for development). Use a proper QR generator in production. -->
        <img src="https://chart.googleapis.com/chart?chs=220x220&cht=qr&chl={{ uri|urlencode }}" alt="TOTP QR"/>
      </div>

      <div class="mb-2"><strong>Secret:</strong> <code>{{ secret }}</code></div>
      <form method="post" action="{{ url_for('twofa_confirm') }}">
        <div class="mb-2">
          <input name="code" class="form-control text-center" placeholder="Enter 6-digit code from app" />
        </div>
        <div class="d-flex gap-2">
          <button class="btn btn-accent">Confirm & enable</button>
          <a class="btn btn-light" href="{{ url_for('dashboard') }}">Cancel</a>
        </div>
      </form>
      <div class="mt-3 small-muted">If you lose access to your authenticator, you'll need account recovery (not handled here).</div>
    </div>
  </div>
</div>
{% endblock %}
