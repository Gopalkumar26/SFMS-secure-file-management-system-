{% extends "base.html" %}
{% block title %}Share File â€” SFMS{% endblock %}
{% block content %}
<div class="row justify-content-center">
  <div class="col-md-8">
    <div class="card p-3 card-compact">
      <h5>Share: {{ f['filename'] }}</h5>

      <form method="post" class="row g-2 mb-3">
        <div class="col-md-8">
          <input name="username" class="form-control" placeholder="username to share with" />
        </div>
        <div class="col-md-4">
          <button class="btn btn-accent w-100">Share</button>
        </div>
      </form>

      <h6>Current shares</h6>
      {% if shares %}
        <ul class="list-group">
          {% for s in shares %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
              <div>
                <div><strong>{{ s['username'] }}</strong></div>
                <div class="small-muted">Shared: {{ s['created_at'][:19] }}</div>
              </div>
              <form method="post" action="{{ url_for('unshare_file', file_id=f['id']) }}" onsubmit="return confirmAction('Remove sharing for {{ s.username }}?');">
                <input type="hidden" name="share_id" value="{{ s['share_id'] }}" />
                <button class="btn btn-sm btn-outline-danger">Unshare</button>
              </form>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <div class="small-muted">This file is not shared with anyone.</div>
      {% endif %}
      <div class="mt-3"><a class="btn btn-light" href="{{ url_for('dashboard') }}">Back to dashboard</a></div>
    </div>
  </div>
</div>
{% endblock %}
